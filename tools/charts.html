<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ion Mining Group â€” Charts</title>
    <link rel="manifest" href="./manifest.json">
    <link rel="stylesheet" href="./shared.css?v=44">
    <script>
    if (!localStorage.getItem('sw_clean_v44') && 'serviceWorker' in navigator) {
        navigator.serviceWorker.getRegistrations().then(function(r) {
            var p = r.map(function(x) { return x.unregister(); });
            p.push(caches.keys().then(function(k) { return Promise.all(k.map(function(n) { return caches.delete(n); })); }));
            Promise.all(p).then(function() { localStorage.setItem('sw_clean_v44', '1'); location.reload(); });
        });
    }
    </script>
    <script src="./chart.min.js?v=44"></script>
</head>
<body>
<canvas id="techLinesCanvas"></canvas>

<nav id="ion-nav"></nav>

<header style="text-align:center; padding:24px 16px 12px; border-bottom:1px solid rgba(255,255,255,0.06); backdrop-filter:blur(10px); -webkit-backdrop-filter:blur(10px);">
    <h1 style="font-size:28px; font-weight:600; color:#f7931a; margin-bottom:4px;">Network Data</h1>
    <p style="color:#888; font-size:14px;">Live Bitcoin price, difficulty, and hashrate</p>
    <div id="chartsStatus" style="font-size:12px; color:#555; margin-top:6px;"></div>
</header>

<main>

    <!-- ===== BTC PRICE CHART ===== -->
    <div class="card" style="margin-bottom:20px;">
        <div class="chart-title-row">
            <h3 id="priceTitle">BTC Price (90 Days)</h3>
            <span id="priceValue" class="chart-live-value" style="color:#f7931a;">--</span>
        </div>
        <div class="time-range-selector" id="priceRange">
            <button data-days="7">7D</button>
            <button data-days="30">30D</button>
            <button data-days="90" class="active">90D</button>
            <button data-days="180">180D</button>
            <button data-days="365">1Y</button>
            <button data-days="max">MAX</button>
        </div>
        <div class="earnings-chart-container">
            <canvas id="priceChart"></canvas>
        </div>
    </div>

    <!-- ===== NETWORK STATS ===== -->
    <div class="section-label">Network Stats</div>
    <section class="fleet-grid" id="networkStatsGrid">
        <div class="metric-card">
            <div class="label">Block Height</div>
            <div class="value btc-orange" id="nsBlockHeight">--</div>
            <div class="sub" id="nsBlockHeightSub">loading...</div>
        </div>
        <div class="metric-card">
            <div class="label">Mempool Size</div>
            <div class="value" id="nsMempoolCount">--</div>
            <div class="sub" id="nsMempoolSize">--</div>
        </div>
        <div class="metric-card">
            <div class="label">Fastest Fee</div>
            <div class="value positive" id="nsFastFee">--</div>
            <div class="sub">sat/vB</div>
        </div>
        <div class="metric-card">
            <div class="label">Medium Fee</div>
            <div class="value neutral" id="nsMedFee">--</div>
            <div class="sub">sat/vB (30 min)</div>
        </div>
        <div class="metric-card">
            <div class="label">Economy Fee</div>
            <div class="value neutral" id="nsEcoFee">--</div>
            <div class="sub">sat/vB (1 hour)</div>
        </div>
        <div class="metric-card">
            <div class="label">Avg Block Time</div>
            <div class="value" id="nsAvgBlockTime">--</div>
            <div class="sub" id="nsAvgBlockTimeSub">minutes (since last adj.)</div>
        </div>
        <div class="metric-card">
            <div class="label">Mempool Weight</div>
            <div class="value" id="nsMempoolWeight">--</div>
            <div class="sub" id="nsMempoolWeightSub">% of block capacity</div>
        </div>
    </section>

    <!-- ===== BITCOIN SUPPLY TRACKER ===== -->
    <div class="card" id="supplyCard" style="display:none; margin-bottom:20px;">
        <div class="chart-title-row">
            <h3>Bitcoin Supply Tracker</h3>
            <span class="chart-live-value btc-orange" id="supplyMined">--</span>
        </div>
        <div class="fleet-grid" style="margin-bottom:16px;">
            <div class="metric-card">
                <div class="label">Total Mined</div>
                <div class="value btc-orange" id="supplyTotal">--</div>
                <div class="sub" id="supplyTotalSub">BTC</div>
            </div>
            <div class="metric-card">
                <div class="label">% of 21M</div>
                <div class="value positive" id="supplyPercent">--%</div>
                <div class="sub" id="supplyPercentSub">--</div>
            </div>
            <div class="metric-card">
                <div class="label">Inflation Rate</div>
                <div class="value neutral" id="supplyInflation">--%</div>
                <div class="sub">annual</div>
            </div>
            <div class="metric-card">
                <div class="label">Stock-to-Flow</div>
                <div class="value" id="supplyS2F">--</div>
                <div class="sub" id="supplyS2FSub">ratio</div>
            </div>
            <div class="metric-card">
                <div class="label">Remaining BTC</div>
                <div class="value negative" id="supplyRemaining">--</div>
                <div class="sub">left to mine</div>
            </div>
        </div>
        <div class="halving-progress-bar">
            <div class="halving-progress-fill" id="supplyProgressBar" style="width:0%"></div>
        </div>
    </div>

    <!-- ===== HALVING COUNTDOWN ===== -->
    <div class="card" id="halvingCard" style="display:none; margin-bottom:20px;">
        <div class="chart-title-row">
            <h3>Bitcoin Halving Countdown</h3>
            <span class="chart-live-value btc-orange" id="halvingBlocksLeft">--</span>
        </div>
        <div class="fleet-grid" style="margin-bottom:16px;">
            <div class="metric-card">
                <div class="label">Blocks Remaining</div>
                <div class="value btc-orange" id="halvingRemaining">--</div>
                <div class="sub" id="halvingTarget">--</div>
            </div>
            <div class="metric-card">
                <div class="label">Estimated Date</div>
                <div class="value" id="halvingEstDate">--</div>
                <div class="sub" id="halvingEstTime">--</div>
            </div>
            <div class="metric-card">
                <div class="label">Current Epoch</div>
                <div class="value" id="halvingEpoch">--</div>
                <div class="sub" id="halvingReward">--</div>
            </div>
            <div class="metric-card">
                <div class="label">Epoch Progress</div>
                <div class="value positive" id="halvingProgress">--%</div>
                <div class="sub" id="halvingProgressSub">--</div>
            </div>
            <div class="metric-card">
                <div class="label">Days Remaining</div>
                <div class="value neutral" id="halvingDays">--</div>
                <div class="sub">estimated</div>
            </div>
        </div>
        <div class="halving-progress-bar">
            <div class="halving-progress-fill" id="halvingProgressBar" style="width:0%"></div>
        </div>
    </div>

    <!-- ===== DIFFICULTY ADJUSTMENT COUNTDOWN ===== -->
    <div class="section-label">Difficulty Adjustment</div>
    <section class="fleet-grid">
        <div class="metric-card">
            <div class="label">Blocks Remaining</div>
            <div class="value btc-orange" id="diffBlocks">--</div>
            <div class="sub" id="diffProgress">--% complete</div>
        </div>
        <div class="metric-card">
            <div class="label">Est. Time Remaining</div>
            <div class="value" id="diffTime">--</div>
            <div class="sub" id="diffDate">--</div>
        </div>
        <div class="metric-card">
            <div class="label">Est. Difficulty Change</div>
            <div class="value" id="diffChange">--</div>
            <div class="sub">vs current epoch</div>
        </div>
        <div class="metric-card">
            <div class="label">Current Difficulty</div>
            <div class="value" id="diffCurrent">--</div>
            <div class="sub">trillions</div>
        </div>
    </section>
    <div class="card" style="padding: 14px 20px; margin-bottom:20px;">
        <div class="halving-progress-bar">
            <div class="halving-progress-fill" id="diffProgressBar" style="width: 0%"></div>
        </div>
    </div>

    <!-- ===== NETWORK DIFFICULTY CHART ===== -->
    <div class="card" style="margin-bottom:20px;">
        <div class="chart-title-row">
            <h3 id="diffTitle">Network Difficulty (1 Year)</h3>
            <span id="diffValue" class="chart-live-value" style="color:#4ade80;">--</span>
        </div>
        <div class="time-range-selector" id="miningRange">
            <button data-tf="3m">3M</button>
            <button data-tf="6m">6M</button>
            <button data-tf="1y" class="active">1Y</button>
            <button data-tf="3y">3Y</button>
            <button data-tf="all">ALL</button>
        </div>
        <div class="earnings-chart-container">
            <canvas id="difficultyChart"></canvas>
        </div>
    </div>

    <!-- ===== NETWORK HASHRATE CHART ===== -->
    <div class="card" style="margin-bottom:20px;">
        <div class="chart-title-row">
            <h3 id="hashTitle">Network Hashrate (1 Year)</h3>
            <span id="hashValue" class="chart-live-value" style="color:#60a5fa;">--</span>
        </div>
        <div class="time-range-selector" id="hashRange">
            <button data-tf="3m">3M</button>
            <button data-tf="6m">6M</button>
            <button data-tf="1y" class="active">1Y</button>
            <button data-tf="3y">3Y</button>
            <button data-tf="all">ALL</button>
        </div>
        <div class="earnings-chart-container">
            <canvas id="hashrateChart"></canvas>
        </div>
    </div>

    <!-- ===== HASH PRICE ===== -->
    <div class="card" style="margin-bottom:20px;">
        <div class="chart-title-row">
            <h3 id="hashPriceTitle">Hash Price (90 Days)</h3>
            <span id="hashPriceValue" class="chart-live-value" style="color:#a78bfa;">--</span>
        </div>
        <div class="time-range-selector" id="hashPriceRange">
            <button data-days="7">7D</button>
            <button data-days="30">30D</button>
            <button data-days="90" class="active">90D</button>
            <button data-days="180">180D</button>
            <button data-days="365">1Y</button>
            <button data-days="max">MAX</button>
        </div>
        <div class="earnings-chart-container">
            <canvas id="hashPriceChart"></canvas>
        </div>
    </div>

    <!-- ===== FEE RATE HISTORY ===== -->
    <div class="card" style="margin-bottom:20px;">
        <div class="chart-title-row">
            <h3 id="feeTitle">Fee Rate History</h3>
            <span id="feeValue" class="chart-live-value" style="color:#ef4444;">--</span>
        </div>
        <div class="time-range-selector" id="feeRange">
            <button data-tf="24h" class="active">24H</button>
            <button data-tf="3d">3D</button>
            <button data-tf="1w">1W</button>
            <button data-tf="1m">1M</button>
            <button data-tf="3m">3M</button>
            <button data-tf="6m">6M</button>
            <button data-tf="1y">1Y</button>
        </div>
        <div class="earnings-chart-container">
            <canvas id="feeChart"></canvas>
        </div>
    </div>

    <!-- ===== MINING POOL DOMINANCE ===== -->
    <div class="card" style="margin-bottom:20px;">
        <div class="chart-title-row">
            <h3 id="poolTitle">Mining Pool Dominance (1 Week)</h3>
            <span id="poolValue" class="chart-live-value" style="color:#f7931a;">--</span>
        </div>
        <div class="time-range-selector" id="poolRange">
            <button data-tf="24h">24H</button>
            <button data-tf="3d">3D</button>
            <button data-tf="1w" class="active">1W</button>
            <button data-tf="1m">1M</button>
            <button data-tf="3m">3M</button>
            <button data-tf="6m">6M</button>
            <button data-tf="1y">1Y</button>
            <button data-tf="all">ALL</button>
        </div>
        <div class="earnings-chart-container" style="height:350px;">
            <canvas id="poolChart"></canvas>
        </div>
    </div>

    <!-- ===== BLOCK EXPLORER ===== -->
    <div class="card" id="blockExplorerCard" style="margin-bottom:20px;">
        <div class="chart-title-row">
            <h3>Latest Blocks</h3>
            <span class="chart-live-value btc-orange" id="blockExplorerHeight">--</span>
        </div>
        <div class="table-scroll" id="blockExplorerTable">
            <table>
                <thead>
                    <tr>
                        <th>Height</th>
                        <th>Time</th>
                        <th>Pool</th>
                        <th>TXs</th>
                        <th>Size</th>
                        <th>Fees</th>
                    </tr>
                </thead>
                <tbody id="blockExplorerBody">
                    <tr><td colspan="6" style="text-align:center; color:#555;">Loading...</td></tr>
                </tbody>
            </table>
        </div>
    </div>

</main>

<footer>
    <p>Ion Mining Group &copy; 2025</p>
</footer>

<script src="./shared.js?v=44"></script>
<script src="./fleet-data.js?v=44"></script>
<script src="./charts.js?v=44"></script>
<script src="./alerts.js?v=44"></script>
</body>
</html>
